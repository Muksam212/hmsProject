{% extends 'hospitalmanagementapp/base.html' %}
{% load bootstrap %}
{% block content %}



<div class="container">
    <div class="row">
        <div class="col-sm-4">
            <a href="{% url 'hospitalmanagementapp:doctor-pdf' %}" class="btn btn-info"> Pdf Format </a>
        </div>
    </div>
</div>

<div class="container">
    <div class="row justify-content-end">
        <form class="search-form" method="GET">
            {{ doctor_filter.form|bootstrap }}
            <div class="form-group">
                <button type="submit" class="btn btn-outline-primary"><i class="fas fa-search"></i></button>
            </div>
        </form>
    </div>
</div>
<div class="container">
	<div class="table-wrapper">
		<div class="table-title">
			<div class="row">
				<h2> Manage <b> Doctor </b></h2>
			</div>
		</div>
	</div>
	<table class="table table-bordered">
		<thead>
			<tr>
				<th> Id </th>
				<th> Name </th>
				<th> Address </th>
				<th> Email </th>
				<th> Phone Number </th>
				<th> Photo </th>
				<th> Specialist </th>
				<th> Date Created </th>
				<th> Action </th>
			</tr>
		</thead>
		<tbody>
			{% for doc in doctor_filter.qs %}
			<tr>
				<td> {{ forloop.counter }} </td>
				<td> {{ doc.name }} </td>
				<td> {{ doc.address }}</td>
				<td> {{ doc.email }} </td>
				<td> {{ doc.ph_number }} </td>
				<td><a href="{{ doc.photo.url }}"><img src="{{ doc.photo.url }}" style="width:40px;"></td></a>
				<td> {{ doc.specialist }}
				<td> {{ doc.date_created }} </td>

				<td>
                    <a href="{% url 'hospitalmanagementapp:doctor-update' doc.id %}" class="btn btn-info editbtn">Edit </a>
                    <a href="{% url 'hospitalmanagementapp:doctor-delete' doc.id %}" class="btn btn-danger deletebtn"> Delete </a>
                </td>
			</tr>
			{% endfor %}
		</tbody>
	</table>

	<!--Adding Pagination-->
    <div class="container">
        <div class="row justify-content-end">
            <nav aria-label="Page navigation example">
                {% if is_paginated %}
                <ul class="pagination">
                    {% if page_obj.has_previous %}
                    <li class="page-item">
                        <a class="page-link" href="?page={{page_obj.previous_page_number}}">&laquo;</a>
                    </li>
                    {% else %}
                    <li class="page-item disabled">
                        <a class="page-link" href="#">&laquo;</a>
                    </li>
                    {% endif %} {% for i in paginator.page_range %} {% if page_obj.number == i %}
                    <li class="page-item"><a class="page-link active">{{ i }}</a></li>
                    {% else %}
                    <li class="page-item">
                        <a class="page-link" href="?page={{ i }}">{{ i }}</a>
                    </li>
                    {% endif %} {% endfor %} {% if page_obj.has_next %}
                    <li class="page-item">
                        <a href="?page={{page_obj.next_page_number}}" class="page-link">&raquo;</a>
                    </li>
                    {% else %}
                    <li class="page-item disabled">
                        <a class="page-link">&raquo;</a>
                    </li>
                    {% endif %}
                </ul>
                {% endif %}
            </nav>
        </div>
    </div>


	<!--Edit Doctor-->
	<div id="editDoctorModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="..."
            aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
            </div>
        </div>
    </div>

    <!--delete doctor-->
    <div id="deleteDoctorModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="..."
            aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
            </div>
        </div>
    </div>
</div>

{% endblock content %}

{% block js %}
{% if messages %}
	{% for message in messages %}
		<script>
			swal({
				title:'Good Job!',
				text: '{{ message }}',
				icon: 'success',
			});
		</script>
	{% endfor %}
{% endif %}
<script>
	$('.editbtn').on('click', function (e) {
        e.preventDefault()
        var url = $(this).attr('href');
        $.get(url, function (data) {
            console.log(data)
            $('#editDoctorModal').modal('show');
            $('#editDoctorModal .modal-content').empty().append(data)
        })
    })

    $('.deletebtn').on('click', function (e) {
        e.preventDefault()
        var url = $(this).attr('href');
        $.get(url, function (data) {
            console.log(data)
            $('#deleteDoctorModal').modal('show');
            $('#deleteDoctorModal .modal-content').empty().append(data)
        })
    })
</script>
{% endblock js %}